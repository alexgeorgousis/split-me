<div
  id="receipt_item_<%= receipt_item.id %>"
  class="border rounded-md overflow-hidden transition-all <%= receipt_item.undecided? ? "border-gray-600 bg-gray-800 hover:border-blue-500 hover:shadow-lg hover:shadow-blue-500/20" : "border-blue-500 bg-blue-900/20" %> relative">

  <%= button_to split_receipt_item_path(receipt_item.receipt.split, receipt_item),
    method: :patch,
    params: { split_mode: receipt_item.undecided? ? 'mine' : 'undecided' },
    form_class: "w-full",
    class: "w-full text-left p-4 cursor-pointer",
    onclick: "if (window.getSelection().toString()) { event.preventDefault(); return false; }" do %>
    <div class="flex justify-between items-start pr-24">
      <div class="flex items-start space-x-3">
        <div class="flex-1">
          <h3 class="font-medium text-lg select-text"><%= receipt_item.name %></h3>
          <div class="text-sm text-gray-400 mt-1">
            <span class="select-text">Price: £<%= sprintf("%.2f", receipt_item.price) %></span>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <div class="absolute top-4 right-4 z-20 flex space-x-2">
    <%= button_to toggle_favourite_split_receipt_item_path(receipt_item.receipt.split, receipt_item),
      method: :post,
      form_class: "inline-block",
      class: "rounded-full border-2 border-pink-600 p-1 bg-gray-800" do %>
      <%= icon receipt_item.favourite? ? "heart_filled" : "heart_unfilled", css_class: "w-6 h-6 text-pink-700 hover:text-pink-600 cursor-pointer" %>
    <% end %>
    <%= button_to split_receipt_item_path(receipt_item.receipt.split, receipt_item),
      method: :delete,
      form: { data: { turbo_confirm: "Are you sure you want to delete this item?" } },
      form_class: "inline-block",
      class: "rounded-full border-2 border-red-600 p-1 bg-gray-800" do %>
      <%= icon "bin", css_class: "w-6 h-6 text-red-700 hover:text-red-600 cursor-pointer" %>
    <% end %>
  </div>

  <div class="border-t border-gray-700 bg-gray-800 px-4 py-3 <%= receipt_item.undecided? ? 'hidden' : 'block' %>">
    <div class="flex items-center justify-between mb-2">
      <span
        class="text-xs text-gray-400">Your share: £<%= receipt_item.my_share %>
    </span>
    </div>

    <div class="flex flex-row justify-evenly">

      <%= button_to split_receipt_item_path(receipt_item.receipt.split, receipt_item),
        method: :patch,
        params: { split_mode: "mine" },
        class: "rounded-full border-2 p-2 transition-all cursor-pointer #{receipt_item.mine? ? 'border-green-400 bg-green-900/20' : 'border-gray-600 bg-gray-800 hover:border-green-600 hover:bg-green-900/20'}" do %>
        <%= icon "hand_raised", css_class: "w-6 h-6 #{receipt_item.mine? ? 'text-green-400' : 'text-gray-400'}" %>
      <% end %>

      <%= button_to split_receipt_item_path(receipt_item.receipt.split, receipt_item),
        method: :patch,
        params: { split_mode: "shared" },
        class: "rounded-full border-2 p-2 transition-all cursor-pointer relative overflow-hidden #{receipt_item.shared? ? 'border-green-400' : 'border-gray-600 hover:border-yellow-600 hover:bg-yellow-900/20'}" do %>
        <%= icon "people", css_class: "w-6 h-6 relative z-10 #{receipt_item.shared? ? 'text-orange-400' : 'text-gray-400'}" %>
      <% end %>

    </div>
  </div>
</div>
